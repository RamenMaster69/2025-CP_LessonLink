<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LessonLink - Faculty Management</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#11468F',
                        secondary: '#9E5EFF',
                        accent: '#3b82f6'
                    }
                }
            }
        }
    </script>
    <style>
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideIn {
            from {
                transform: translateX(-100%);
            }
            to {
                transform: translateX(0);
            }
        }

        @keyframes scaleIn {
            from {
                opacity: 0;
                transform: scale(0.9) translateY(-10px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        .sidebar-transition {
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .dropdown-enter {
            animation: scaleIn 0.2s ease-out;
        }

        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }

        /* Real-time update animation */
        @keyframes pulseUpdate {
            0% { background-color: transparent; }
            50% { background-color: rgba(59, 130, 246, 0.1); }
            100% { background-color: transparent; }
        }

        .updating {
            animation: pulseUpdate 1s ease-in-out;
        }

        /* Print Styles */
        @media print {
            * {
                -webkit-print-color-adjust: exact !important;
                color-adjust: exact !important;
            }
            
            body * {
                visibility: hidden;
            }
            
            #printable-section,
            #printable-section * {
                visibility: visible;
            }
            
            #printable-section {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                background: white;
            }
            
            .print-header {
                text-align: center;
                margin-bottom: 20px;
                border-bottom: 2px solid #000;
                padding-bottom: 15px;
            }
            
            .print-header h1 {
                font-size: 24px;
                font-weight: bold;
                margin: 0 0 5px 0;
                color: #000;
            }
            
            .print-header h2 {
                font-size: 18px;
                margin: 5px 0;
                color: #666;
            }
            
            .print-header p {
                margin: 5px 0;
                color: #333;
            }
            
            .print-table {
                width: 100%;
                border-collapse: collapse;
                margin-top: 20px;
                font-size: 12px;
            }
            
            .print-table th,
            .print-table td {
                border: 1px solid #000;
                padding: 8px 6px;
                text-align: left;
                vertical-align: top;
            }
            
            .print-table th {
                background-color: #f0f0f0 !important;
                font-weight: bold;
                color: #000;
            }
            
            .print-footer {
                margin-top: 30px;
                text-align: center;
                font-size: 11px;
                border-top: 1px solid #000;
                padding-top: 10px;
                color: #666;
            }
            
            .no-print {
                display: none !important;
            }
        }
    </style>
</head>

<body class="bg-gray-50 min-h-screen">
    <!-- Header - Fixed at top -->
    <header class="bg-white shadow-sm border-b fixed top-0 left-0 right-0 z-40">
        <div class="flex items-center justify-between px-4 py-3 md:px-6 md:py-4">
            <!-- Mobile menu button -->
            <button id="mobile-menu-btn"
                class="md:hidden p-2 text-purple-600 hover:bg-purple-50 rounded-lg transition-colors">
                <i class="fas fa-bars text-lg"></i>
            </button>

            <!-- Logo -->
            <div class="flex items-center space-x-3 flex-1 md:flex-none">
                <div class="w-10 h-10 bg-gradient-to-r from-primary to-secondary rounded-full shadow-md"></div>
                <div class="hidden sm:block">
                    <h1 class="text-xl font-bold text-gray-900">LessonLink</h1>
                    <p class="text-sm text-gray-500 hidden lg:block">Western Mindanao State University</p>
                </div>
            </div>

            <!-- Right side actions -->
            <div class="flex items-center space-x-2 md:space-x-4">
                <!-- Search -->
                <div class="relative hidden md:block">
                    <input type="text" placeholder="Search faculty..."
                        class="w-64 px-4 py-2 bg-gray-50 border border-gray-200 rounded-full focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all">
                    <i class="fas fa-search absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                </div>

                <!-- Mobile search button -->
                <button class="md:hidden p-2 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors">
                    <i class="fas fa-search text-lg"></i>
                </button>

                <!-- Notifications -->
                <div class="relative">
                    <button id="notification-btn"
                        class="relative p-2 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors">
                        <i class="fas fa-bell text-lg"></i>
                        <span id="notification-badge"
                            class="absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full"></span>
                    </button>

                    <!-- Notifications Dropdown -->
                    <div id="notification-dropdown"
                        class="absolute right-0 mt-2 w-80 bg-white rounded-xl shadow-lg border border-gray-200 hidden z-50">
                        <div class="p-4 border-b border-gray-100">
                            <div class="flex items-center justify-between">
                                <h3 class="font-semibold text-gray-900">Notifications</h3>
                                <button class="text-purple-600 text-sm hover:text-purple-700">Mark all read</button>
                            </div>
                        </div>
                        <div class="max-h-96 overflow-y-auto">
                            <div class="p-4 hover:bg-gray-50 border-b border-gray-100">
                                <div class="flex items-start space-x-3">
                                    <div class="w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0"></div>
                                    <div class="flex-1">
                                        <p class="text-sm text-gray-900 font-medium">New lesson plan submitted</p>
                                        <p class="text-xs text-gray-500 mt-1">Grade 3A English lesson ready for review
                                        </p>
                                        <p class="text-xs text-gray-400 mt-1">2 minutes ago</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Profile -->
                <div class="relative">
                    <button id="profile-btn"
                        class="w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center hover:bg-gray-300 transition-colors">
                        <i class="fas fa-user text-gray-500"></i>
                    </button>

                    <!-- Profile Dropdown -->
                    <div id="profile-dropdown"
                        class="absolute right-0 mt-2 w-64 bg-white rounded-xl shadow-lg border border-gray-200 hidden z-50">
                        <div class="p-4 border-b border-gray-100">
                            <div class="flex items-center space-x-3">
                                <div
                                    class="w-12 h-12 rounded-full bg-gradient-to-br from-purple-600 to-blue-600 flex items-center justify-center">
                                    <i class="fas fa-user text-white text-lg"></i>
                                </div>
                                <div>
                                    <p class="font-semibold text-gray-900">{{ user.first_name }} {{ user.last_name }}</p>
                                    <p class="text-sm text-gray-500">Department of {{ user.department }}</p>
                                </div>
                            </div>
                        </div>
                        <div class="py-2">
                            <a href="{% url 'profile' %}"
                                class="flex items-center space-x-3 px-4 py-3 text-gray-700 hover:bg-gray-50 transition-colors">
                                <i class="fas fa-user w-4"></i>
                                <span>My Profile</span>
                            </a>
                            <a href="#"
                                class="flex items-center space-x-3 px-4 py-3 text-gray-700 hover:bg-gray-50 transition-colors">
                                <i class="fas fa-cog w-4"></i>
                                <span>Settings</span>
                            </a>
                            <hr class="my-2">
                            <a href="{% url 'logout' %}"
                                class="flex items-center space-x-3 px-4 py-3 text-red-600 hover:bg-red-50 transition-colors">
                                <i class="fas fa-sign-out-alt w-4"></i>
                                <span>Logout</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <div class="flex pt-16">
        <!-- Sidebar - Fixed and sticky -->
        <aside id="sidebar"
            class="w-64 bg-white shadow-lg h-screen fixed top-20 left-0 -translate-x-full md:translate-x-0 sidebar-transition z-30 overflow-y-auto">
            <nav class="p-4 space-y-2">
                <!-- Quick Actions Button -->
                <a href="{% url 'lesson_ai' %}">
                    <button class="w-full flex items-center space-x-3 px-4 py-3 bg-gradient-to-r from-[#11468F] to-[#9E5EFF] text-white rounded-lg hover:from-[#0d3a7a] hover:to-[#8c4de6] shadow-md">
                        <i class="fas fa-plus text-lg"></i>
                        <span class="font-medium">Create Lesson</span>
                    </button>
                </a>

                <!-- Navigation Items -->
                <a href="{% url 'Dep_Dash' %}"
                    class="flex items-center space-x-3 px-4 py-3 text-gray-700 hover:bg-[#f0f5ff] rounded-lg transition-colors group">
                    <i class="fas fa-home text-lg w-5 group-hover:text-primary transition-colors"></i>
                    <span>Dashboard</span>
                </a>
                <a href="{% url 'department_head_drafts' %}"
                    class="flex items-center space-x-3 px-4 py-3 text-gray-700 hover:bg-[#f0f5ff] rounded-lg transition-colors group">
                    <i class="fas fa-file-alt text-lg w-5 group-hover:text-[#11468F] transition-colors"></i>
                    <span>My Lesson Plans</span>
                </a>
                <a href="{% url 'dep_calendar' %}"
                    class="flex items-center space-x-3 px-4 py-3 text-gray-700 hover:bg-[#f0f5ff] rounded-lg transition-colors group]">
                    <i class="fas fa-calendar text-lg w-5"></i>
                    <span class="font-medium">Calendar</span>
                </a>
                <a href="{% url 'Dep_Pending' %}"
                    class="flex items-center space-x-3 px-4 py-3 text-gray-700 hover:bg-[#f0f5ff] rounded-lg transition-colors group">
                    <i class="fas fa-clock text-lg w-5 group-hover:text-primary transition-colors"></i>
                    <span>Pending Reviews</span>
                </a>
                <a href="#"
                    class="flex items-center space-x-3 px-4 py-3 text-primary bg-[#f0f5ff] rounded-lg border border-[#d6e0ff]">
                    <i class="fas fa-users text-lg w-5"></i>
                    <span class="font-medium">Faculty</span>
                </a>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 p-4 md:p-6 md:ml-64">
            <!-- Page Header -->
            <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6">
                <div>
                    <h1 class="text-2xl font-bold text-gray-900 mb-2">{{ department }} Department Faculty</h1>
                    <p class="text-gray-600">View and manage {{ department }} department faculty members</p>
                </div>
                <div class="flex space-x-3 mt-4 sm:mt-0">
                    <button class="bg-white text-gray-700 px-4 py-2 rounded-lg border border-gray-300 hover:bg-gray-50 transition-colors flex items-center space-x-2">
                        <i class="fas fa-filter"></i>
                        <span>Filter</span>
                    </button>
                    <button class="bg-accent text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2">
                        <i class="fas fa-plus"></i>
                        <span>Add Faculty</span>
                    </button>
                </div>
            </div>

            <!-- Dynamic Stats Cards -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6" id="stats-cards">
                <!-- Total Faculty Card -->
                <div class="bg-white rounded-lg shadow-sm border p-6" id="total-faculty-card">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-600 text-sm font-medium">Total Faculty</p>
                            <p class="text-3xl font-bold text-gray-900">{{ total_faculty }}</p>
                            <p class="text-xs text-gray-500 mt-1">Active members in department</p>
                        </div>
                        <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-users text-blue-600 text-xl"></i>
                        </div>
                    </div>
                </div>

                <!-- Pending Reviews Card -->
                <div class="bg-white rounded-lg shadow-sm border p-6" id="pending-reviews-card">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-600 text-sm font-medium">Pending Reviews</p>
                            <p class="text-3xl font-bold text-gray-900">{{ pending_reviews }}</p>
                            <p class="text-xs text-gray-500 mt-1">Awaiting your review</p>
                        </div>
                        <div class="w-12 h-12 bg-yellow-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-exclamation-triangle text-yellow-600 text-xl"></i>
                        </div>
                    </div>
                </div>
                
                <!-- Active Teachers Card -->
                <div class="bg-white rounded-lg shadow-sm border p-6" id="active-teachers-card">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-600 text-sm font-medium">Active Teachers</p>
                            <p class="text-3xl font-bold text-gray-900">{{ active_teachers }}</p>
                            <p class="text-xs text-gray-500 mt-1">Full-time teaching staff</p>
                        </div>
                        <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-chalkboard-teacher text-green-600 text-xl"></i>
                        </div>
                    </div>
                </div>
                
                <!-- Student Teachers Card -->
                <div class="bg-white rounded-lg shadow-sm border p-6" id="student-teachers-card">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-600 text-sm font-medium">Student Teachers</p>
                            <p class="text-3xl font-bold text-gray-900">{{ student_teachers }}</p>
                            <p class="text-xs text-gray-500 mt-1">Currently training</p>
                        </div>
                        <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-user-graduate text-purple-600 text-xl"></i>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Faculty Table -->
            <div class="bg-white rounded-lg shadow-sm border">
                <!-- Table Header -->
                <div class="px-6 py-4 border-b border-gray-200">
                    <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between">
                        <h2 class="text-lg font-semibold text-gray-900 mb-4 sm:mb-0">{{ department }} Department Members</h2>
                        <div class="flex items-center space-x-3">
                            <button id="refresh-btn" class="flex items-center space-x-2 px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">
                                <i class="fas fa-sync-alt"></i>
                                <span>Refresh</span>
                            </button>
                            <button id="print-btn" class="flex items-center space-x-2 px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">
                                <i class="fas fa-print"></i>
                                <span>Print</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Table Content -->
                <div class="overflow-x-auto">
                    <table class="w-full" id="faculty-table">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Role</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Last Active</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Pending Reviews</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider no-print">Actions</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200" id="faculty-table-body">
                            {% for member_data in faculty_members %}
                            {% with member=member_data.user %}
                            <tr class="hover:bg-gray-50 fade-in faculty-row" data-user-id="{{ member.id }}">
                                <!-- Avatar + Name -->
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="flex items-center">
                                        <div class="w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center no-print">
                                            <span class="text-blue-600 font-semibold">
                                                {{ member.first_name|first }}{{ member.last_name|first }}
                                            </span>
                                        </div>
                                        <div class="ml-3">
                                            <p class="text-sm font-medium text-gray-900">
                                                {{ member.first_name }} {{ member.last_name }}
                                            </p>
                                            <p class="text-sm text-gray-500">{{ member.email }}</p>
                                        </div>
                                    </div>
                                </td>

                                <!-- Role -->
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full 
                                        {% if member.role == 'Teacher' %} bg-purple-100 text-purple-800 
                                        {% elif member.role == 'Student Teacher' %} bg-pink-100 text-pink-800 
                                        {% else %} bg-blue-100 text-blue-800 {% endif %}">
                                        {{ member.role }}
                                    </span>
                                </td>

                                <!-- Status -->
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full 
                                        {% if member_data.is_active %} bg-green-100 text-green-800 
                                        {% else %} bg-gray-100 text-gray-800 {% endif %}">
                                        {% if member_data.is_active %}Active{% else %}Inactive{% endif %}
                                    </span>
                                </td>

                                <!-- Last Active -->
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                    {% if member_data.last_active %}
                                        {{ member_data.last_active|timesince }} ago
                                    {% else %}
                                        Never
                                    {% endif %}
                                </td>

                                <!-- Pending Reviews -->
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full 
                                        {% if member_data.pending_reviews > 0 %} bg-yellow-100 text-yellow-800 
                                        {% else %} bg-gray-100 text-gray-800 {% endif %}">
                                        {{ member_data.pending_reviews }} pending
                                    </span>
                                </td>

                                <!-- Actions -->
                                <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium no-print">
                                    <div class="flex items-center space-x-2">
                                        <button class="text-blue-600 hover:text-blue-800 transition-colors" title="View Profile">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                        <button class="text-green-600 hover:text-green-800 transition-colors" title="Send Message">
                                            <i class="fas fa-envelope"></i>
                                        </button>
                                        <button class="text-gray-400 hover:text-gray-600 transition-colors" title="More Options">
                                            <i class="fas fa-ellipsis-v"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            {% endwith %}
                            {% empty %}
                            <tr>
                                <td colspan="6" class="px-6 py-4 text-center text-sm text-gray-500">
                                    No faculty members found in your department.
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </main>

        <!-- Overlay for mobile -->
        <div id="overlay" class="fixed inset-0 bg-black bg-opacity-50 z-20 hidden"></div>
    </div>

    <!-- Hidden printable section -->
    <div id="printable-section" style="display: none;">
        <div class="print-header">
            <h1>LessonLink - Faculty Management</h1>
            <h2>Western Mindanao State University</h2>
            <p>{{ department }} Department Faculty Report</p>
            <p>Generated by: {{ user.first_name }} {{ user.last_name }}, {{ department }} Department Head</p>
        </div>
        
        <table class="print-table">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Email</th>
                    <th>Role</th>
                    <th>Status</th>
                    <th>Last Active</th>
                    <th>Pending Reviews</th>
                </tr>
            </thead>
            <tbody id="print-table-body">
                <!-- Content will be populated by JavaScript -->
            </tbody>
        </table>
        
        <div class="print-footer">
            <p>Generated on: <span id="print-date"></span></p>
            <p>Total Faculty: {{ total_faculty }} | Active Teachers: {{ active_teachers }} | Student Teachers: {{ student_teachers }} | Pending Reviews: {{ pending_reviews }}</p>
        </div>
    </div>

    <script>
        // Mobile menu functionality
        const mobileMenuBtn = document.getElementById('mobile-menu-btn');
        const sidebar = document.getElementById('sidebar');
        const overlay = document.getElementById('overlay');

        function toggleMobileMenu() {
            sidebar.classList.toggle('-translate-x-full');
            overlay.classList.toggle('hidden');
            document.body.classList.toggle('overflow-hidden');
        }

        mobileMenuBtn.addEventListener('click', toggleMobileMenu);

        overlay.addEventListener('click', () => {
            sidebar.classList.add('-translate-x-full');
            overlay.classList.add('hidden');
            document.body.classList.remove('overflow-hidden');
        });

        // Profile dropdown functionality
        const profileBtn = document.getElementById('profile-btn');
        const profileDropdown = document.getElementById('profile-dropdown');

        profileBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            profileDropdown.classList.toggle('hidden');
            if (!profileDropdown.classList.contains('hidden')) {
                profileDropdown.classList.add('dropdown-enter');
                // Close notifications dropdown if open
                document.getElementById('notification-dropdown').classList.add('hidden');
            }
        });

        // Notification dropdown functionality
        const notificationBtn = document.getElementById('notification-btn');
        const notificationDropdown = document.getElementById('notification-dropdown');
        const notificationBadge = document.getElementById('notification-badge');

        notificationBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            notificationDropdown.classList.toggle('hidden');
            if (!notificationDropdown.classList.contains('hidden')) {
                notificationDropdown.classList.add('dropdown-enter');
                // Hide notification badge when opened
                notificationBadge.classList.add('hidden');
                // Close profile dropdown if open
                profileDropdown.classList.add('hidden');
            }
        });

        // Close dropdowns when clicking outside
        document.addEventListener('click', (e) => {
            if (!profileBtn.contains(e.target) && !profileDropdown.contains(e.target)) {
                profileDropdown.classList.add('hidden');
            }
            if (!notificationBtn.contains(e.target) && !notificationDropdown.contains(e.target)) {
                notificationDropdown.classList.add('hidden');
            }
        });

        // Real-time data refresh functionality
        const refreshBtn = document.getElementById('refresh-btn');
        const statsCards = document.getElementById('stats-cards');

        async function refreshFacultyData() {
            try {
                // Show loading state
                refreshBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i><span>Refreshing...</span>';
                refreshBtn.disabled = true;

                // Add updating animation to stats cards
                statsCards.querySelectorAll('> div').forEach(card => {
                    card.classList.add('updating');
                });

                // Simulate API call to refresh data
                // In a real application, you would make an AJAX call to your backend
                await new Promise(resolve => setTimeout(resolve, 1000));

                // Reload the page to get fresh data
                window.location.reload();

            } catch (error) {
                console.error('Error refreshing data:', error);
                // Reset button state
                refreshBtn.innerHTML = '<i class="fas fa-sync-alt"></i><span>Refresh</span>';
                refreshBtn.disabled = false;
                
                // Remove updating animation
                statsCards.querySelectorAll('> div').forEach(card => {
                    card.classList.remove('updating');
                });

                alert('Error refreshing data. Please try again.');
            }
        }

        refreshBtn.addEventListener('click', refreshFacultyData);

        // Auto-refresh data every 5 minutes
        setInterval(refreshFacultyData, 5 * 60 * 1000);

        // Print functionality
        const printBtn = document.getElementById('print-btn');
        const printableSection = document.getElementById('printable-section');
        const printTableBody = document.getElementById('print-table-body');
        const printDate = document.getElementById('print-date');

        printBtn.addEventListener('click', () => {
            // Clear previous content
            printTableBody.innerHTML = '';
            
            // Get current date and time
            const now = new Date();
            const dateOptions = { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            };
            printDate.textContent = now.toLocaleDateString('en-US', dateOptions);
            
            // Extract data from the main table
            const mainTable = document.getElementById('faculty-table');
            const rows = mainTable.querySelectorAll('tbody tr');
            
            rows.forEach(row => {
                const cells = row.querySelectorAll('td');
                if (cells.length > 0) {
                    // Extract faculty name and email
                    const nameCell = cells[0];
                    const nameElement = nameCell.querySelector('.text-gray-900');
                    const emailElement = nameCell.querySelector('.text-gray-500');
                    
                    const name = nameElement ? nameElement.textContent.trim() : '';
                    const email = emailElement ? emailElement.textContent.trim() : '';
                    
                    // Extract role
                    const roleSpan = cells[1].querySelector('span');
                    const role = roleSpan ? roleSpan.textContent.trim() : '';
                    
                    // Extract status
                    const statusSpan = cells[2].querySelector('span');
                    const status = statusSpan ? statusSpan.textContent.trim() : '';
                    
                    // Extract last active
                    const lastActive = cells[3] ? cells[3].textContent.trim() : '';
                    
                    // Extract pending reviews
                    const pendingSpan = cells[4].querySelector('span');
                    const pendingReviews = pendingSpan ? pendingSpan.textContent.trim() : '';
                    
                    // Create print table row
                    const printRow = document.createElement('tr');
                    printRow.innerHTML = `
                        <td>${name}</td>
                        <td>${email}</td>
                        <td>${role}</td>
                        <td>${status}</td>
                        <td>${lastActive}</td>
                        <td>${pendingReviews}</td>
                    `;
                    printTableBody.appendChild(printRow);
                }
            });
            
            // Show the printable section and trigger print
            printableSection.style.display = 'block';
            
            // Use setTimeout to ensure the content is rendered before printing
            setTimeout(() => {
                window.print();
                // Hide the printable section after print dialog closes/completes
                setTimeout(() => {
                    printableSection.style.display = 'none';
                }, 100);
            }, 100);
        });

        // Handle window resize
        window.addEventListener('resize', () => {
            if (window.innerWidth >= 768) {
                sidebar.classList.remove('-translate-x-full');
                overlay.classList.add('hidden');
                document.body.classList.remove('overflow-hidden');
            } else {
                sidebar.classList.add('-translate-x-full');
                overlay.classList.add('hidden');
                document.body.classList.remove('overflow-hidden');
            }
        });

        // Add smooth animations on load
        document.addEventListener('DOMContentLoaded', () => {
            const elements = document.querySelectorAll('.fade-in');
            elements.forEach((el, index) => {
                el.style.opacity = '0';
                el.style.transform = 'translateY(20px)';
                setTimeout(() => {
                    el.style.transition = 'all 0.3s ease';
                    el.style.opacity = '1';
                    el.style.transform = 'translateY(0)';
                }, index * 100);
            });

            // Initialize real-time updates
            initializeRealTimeUpdates();
        });

        // Real-time updates simulation
        function initializeRealTimeUpdates() {
            // Simulate real-time updates for demonstration
            // In production, you would use WebSockets or Server-Sent Events
            
            // Update "Last Active" times every minute
            setInterval(() => {
                const lastActiveCells = document.querySelectorAll('td:nth-child(4)');
                lastActiveCells.forEach(cell => {
                    // This is a simulation - in real app, you'd get actual data from server
                    const currentText = cell.textContent;
                    if (currentText.includes('minute') || currentText.includes('hour')) {
                        // Just update the relative time display
                        // In real app, you'd make an API call to get actual last active times
                    }
                });
            }, 60000);

            // Simulate occasional status changes
            setInterval(() => {
                const statusSpans = document.querySelectorAll('td:nth-child(3) span');
                statusSpans.forEach(span => {
                    // 1% chance to toggle status for demo purposes
                    if (Math.random() < 0.01) {
                        const isActive = span.classList.contains('bg-green-100');
                        if (isActive) {
                            span.classList.remove('bg-green-100', 'text-green-800');
                            span.classList.add('bg-gray-100', 'text-gray-800');
                            span.textContent = 'Inactive';
                        } else {
                            span.classList.remove('bg-gray-100', 'text-gray-800');
                            span.classList.add('bg-green-100', 'text-green-800');
                            span.textContent = 'Active';
                        }
                        span.classList.add('updating');
                        setTimeout(() => span.classList.remove('updating'), 1000);
                    }
                });
            }, 30000);
        }

        // Show notification badge after page load (simulate new notifications)
        setTimeout(() => {
            notificationBadge.classList.remove('hidden');
        }, 2000);

        // Handle print events
        window.addEventListener('beforeprint', () => {
            // Ensure printable section is visible before printing
            if (printableSection.style.display === 'none') {
                printableSection.style.display = 'block';
            }
        });

        window.addEventListener('afterprint', () => {
            // Hide printable section after printing
            setTimeout(() => {
                printableSection.style.display = 'none';
            }, 100);
        });

        // Faculty row click handlers
        document.addEventListener('click', (e) => {
            const row = e.target.closest('.faculty-row');
            if (row && !e.target.closest('button')) {
                const userId = row.dataset.userId;
                // Navigate to faculty profile or show details
                console.log('View faculty details for user:', userId);
                // In real app: window.location.href = `/faculty/${userId}/`;
            }
        });
    </script>
</body>
</html>